%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\section{Simulated samples}
\label{sec:simulations}
%-------------------------------------------------------------------------------

An overview of the MC generators used for the main signal and background samples is summarized in Table~\ref{mob}.

Samples of simulated $\ttbar \to WbHq$ ($tt(qH)$) events were generated with the next-to-leading-order (NLO) generator\footnote{In the following, 
the order of a generator should be understood as referring to the order in the strong coupling constant at which the matrix-element (ME) calculation 
is performed.} {\powheg}~v2 \cite{Frixione:2007nw,Nason:2004rx,Frixione:2007vw,Alioli:2010xd}
%{\amcatnlolong}~2.4.3~\cite{Alwall:2014hca}  (referred to in the following as {\amcatnlo})
with the NNPDF3.0 NLO~\cite{Ball:2014uwa} parton distribution function (PDF) set and interfaced to {\pythia} 8.212~\cite{Sjostrand:2007gs} with the NNPDF2.3 LO~\cite{Ball:2012cx} PDF set for the modelling of parton showering (PS), hadronisation, and the underlying event. 
The A14~\cite{ATLASUETune4} set of tuned parameters in {\pythia} controlling the description of multiparton interactions and  
initial- and final-state radiation, referred to as the tune, was used.
The signal sample is normalised to the same total cross section as used for the inclusive $t\bar{t}\to WbWb$ sample (see discussion below) and
assuming a benchmark branching ratio of $\BR_{\mathrm{ref}}(t\to qH)=0.1\%$.
The case of both top quarks decaying into $qH$ is neglected in the analysis given the existing upper limits on $\BR(t \to qH)$ (Section~\ref{sec:intro}).

The $tH$ signal events were generated by {\amcatnlolong}~2.6.2~\cite{Alwall:2014hca}  (referred to in the following as {\amcatnlo})
with the NNPDF3.0 NLO parton distribution function (PDF) set and interfaced to {\pythia} 8.212 with the NNPDF2.3 LO PDF set for the modelling of parton showering,
hadronisation, and the underlying event with the A14 tune.
Depending on either up quark or charm quark involved in the FCNC production, the effective Lagrangian of $tqH$ interaction are parametrised using
dim-6 operators~\cite{fcnc_production_theory}. We obtain $\sigma(ug\to tH)$ = 0.711 pb and $\sigma(cg\to tH)$ = 0.103 pb using $\BR_{\mathrm{ref}}(t\to qH)=0.1\%$ as benchmark.   

The nominal sample used to model the $\ttbar$ background was generated with the NLO generator {\powheg}~v2
%\cite{Frixione:2007nw,Nason:2004rx,Frixione:2007vw,Alioli:2010xd}
using the NNPDF3.0 NLO PDF set. The {\powheg} model parameter $h_{\textrm{damp}}$, which controls 
matrix element to parton shower matching and effectively regulates the high-$\pt$ radiation, was set to 1.5 times the top-quark mass. 
The parton showers, hadronisation, and underlying event were modelled by {\pythia}~8.210 with the NNPDF2.3 LO PDF set in combination with the A14 tune.
Alternative $\ttbar$ simulation samples used to derive parton shower systematic uncertainties are described in Section~\ref{sec:syst_bkgmodeling}. 
The generated $\ttbar$ samples are normalised to a theoretical cross section of $832^{+46}_{-51}$~pb, 
computed using \textsc{Top++}~v2.0~\cite{Czakon:2011xx} at next-to-next-to-leading order (NNLO), 
including resummation of next-to-next-to-leading logarithmic (NNLL) soft gluon 
terms~\cite{Cacciari:2011hy,Baernreuther:2012ws,Czakon:2012zr,Czakon:2012pz,Czakon:2013goa}.

Samples of single-top-quark events corresponding to the $t$-channel production mechanism were generated with the 
{\powheg}~v2~\cite{Frederix:2012dh} generator, using the 4F scheme  for the NLO matrix-element calculations
and the corresponding NNPDF3.0 NLO set of PDFs.
Samples corresponding to the $tW$- and $s$-channel production mechanisms were generated 
with {\powheg}~v2 using the five-flavour scheme. Overlaps between the $\ttbar$ and $tW$ final states were avoided by using 
the diagram removal scheme~\cite{Frixione:2005vw}.
The parton showers, hadronisation and the underlying event were modelled using {\pythia}~8.230~\cite{Sjostrand:2006za} using the A14 tune and the NNPDF2.3 LO PDF set.
%with the CTEQ6L1~\cite{Pumplin:2002vw,Nadolsky:2008zw} PDF set 
%in combination with the Perugia 2012 tune~\cite{Skands:2010ak}.
The single-top-quark samples are normalised to the approximate NNLO theoretical cross 
sections~\cite{Kidonakis:2011wy,Kidonakis:2010ux,Kidonakis:2010tc}. 

Samples of $W/Z$+jets events were generated with the {\sherpa}~2.2.1~\cite{Gleisberg:2008ta} generator. 
The matrix element was calculated for up to two partons at NLO and up to four partons at LO using 
\textsc{Comix}~\cite{Gleisberg:2008fv} and \textsc{OpenLoops}~\cite{Cascioli:2011va}. The matrix-element calculation 
is merged with the {\sherpa} parton shower~\cite{Schumann:2007mg} using the ME+PS@NLO prescription~\cite{Hoeche:2012yf}. 
The PDF set used for the matrix-element calculation is NNPDF3.0 NNLO~\cite{Ball:2014uwa} with a dedicated parton shower tuning developed for {\sherpa}. 
Separate samples were generated for different $W/Z$+jets categories using filters for a $b$-jet 
($W/Z$+$\geq$1$b$+jets), a $c$-jet and no $b$-jet ($W/Z$+$\geq$1$c$+jets), and with a veto on $b$- and $c$-jets 
($W/Z$+light-jets), which are combined into the inclusive $W/Z$+jets samples.
Both the $W$+jets and $Z$+jets samples are normalised to their respective inclusive NNLO theoretical 
cross sections calculated with \textsc{FEWZ}~\cite{Anastasiou:2003ds}.

Samples of $WW/WZ/ZZ$+jets events were generated with {\sherpa}~2.2.1 using the CT10 PDF set
and include processes containing up to four electroweak vertices. 
In the case of $WW/WZ$+jets ($ZZ$+jets) the matrix element was calculated for zero (up to one) additional partons 
at NLO and up to three partons at LO using the same procedure as for the $W/Z$+jets samples. 
The final states simulated require one of the bosons to decay leptonically and the other hadronically.
All diboson samples are normalised to their NLO theoretical cross sections provided by {\sherpa}. 

Samples of $\ttbar V$ and $\ttbar H$ events were generated with {\amcatnlo}~2.2.1, using NLO matrix elements and the NNPDF3.0 NLO PDF set,
and interfaced to {\pythia}~8.210 with the NNPDF2.3 LO PDF set and the A14 tune. 
%Instead, the $\ttbar V$ samples used in the $\Hbb$ search are based on LO matrix elements computed for up to two additional partons 
%using the NNPDF3.0 NLO PDF set, and merged using the CKKW-L approach~\cite{Lonnblad:2001iq}.
The $\ttbar V$ samples are normalised to the NLO cross section computed with {\amcatnlo}, while the $\ttbar H$ sample is normalised using 
the NLO cross section recommended in Ref.~\cite{deFlorian:2016spz}.

Samples of $WH$ and $ZH$, collectively referred to as $VH$ are generated using {\powheg}~v2 \cite{Frixione:2007nw,Nason:2004rx,Frixione:2007vw,Alioli:2010xd}
and interfaced to {\pythia}~8.210 with the NNPDF2.3 LO PDF set and the A14 tune.
The contribution of $tH$ associated production is also considered as part of SM Higgs background.
The sample is generated using {\amcatnlolong}~2.6.2~\cite{Alwall:2014hca} and interfaced with {\pythia}~8.210 with CT10PDF
and A14 tune. The MC predictions are normalised using the NLO cross section recommended in Ref.~\cite{deFlorian:2016spz}. 

All generated samples, except those produced with the {\sherpa}~\cite{Gleisberg:2008ta} event generator, 
utilise \textsc{EvtGen}~1.2.0~\cite{Lange:2001uf} to model the decays of heavy-flavour hadrons. 
To model the effects of pile-up, events from minimum-bias interactions were generated using {\pythia}~8.186~\cite{Sjostrand:2007gs}  
in combination with the A2 tune~\cite{ATL-PHYS-PUB-2011-014}, 
and overlaid onto the simulated hard-scatter events according to the luminosity profile of the recorded data. 
The generated events were processed through a simulation~\cite{Aad:2010ah} of the ATLAS detector geometry and response 
using \textsc{Geant4}~\cite{Agostinelli:2002hh}. A faster simulation, where the full \textsc{Geant4} simulation of
the calorimeter response is replaced by a detailed parameterisation of the shower shapes~\cite{FastCaloSim},
was adopted for some of the samples used to estimate systematic uncertainties in background modelling.
Simulated events were processed through the same reconstruction software as the data, and corrections were applied so that the object identification 
efficiencies, energy scales and energy resolutions match those determined from data control samples.


\begin{table}
\footnotesize
\centering
\caption{Overview of the MC generators used for the main signal and background samples}
\begin{tabular}[h]{l|c|c|c|c|c|c}
\hline \hline
\multirow{2}{*}{Process} & \multicolumn{2}{c|}{Generator} & \multicolumn{2}{c|}{PDF set} & \multirow{2}{*}{Tune} & \multirow{2}{*}{Order} \\ \cline{2-5}
        &  ME   &  PS    &  ME  & PS &   &  \\\hline
$tt(qH)$ Signal & Powheg & Pythia8 & NNPDF30NLO & NNPDF23LO & A14 & NLO \\ \hline
$tH$ Signal & MadGraph5\_aMC@NLO & Pythia8 & NNPDF30NLO & NNPDF23LO & A14 & NLO \\ \hline
$W/Z$+jets & \multicolumn{2}{c|}{Sherpa 2.2.1} & \multicolumn{2}{c|}{NNPDF30NNLO} & Sherpa & NLO/LO \\ \hline
\ttbar & Powheg & Pythia8 & NNPDF30NLO & NNPDF23LO & A14 & NLO \\ \hline
Single top & Powheg & Pythia8 & NNPDF30NLO & NNPDF23LO & A14 & NLO \\ \hline
$t\bar{t}X$ & MadGraph5\_aMC@NLO & Pythia8 & NNPDF30NLO & NNPDF23LO & A14 & NLO \\ \hline
Diboson & \multicolumn{2}{c|}{Sherpa 2.2.1} & \multicolumn{2}{c|}{NNPDF30NNLO} & Sherpa & NLO/LO \\ \hline\hline
\end{tabular}
\label{mob}
\end{table}


%-------------------------------------------------------------------------------
\subsection{Backgrounds with fake leptons}
\label{sec:fakeleptons}
%-------------------------------------------------------------------------------

\subsubsection{Fake electrons and muons}
Electrons and muons only appear in the leptonic channels where there is exactly one electron or muon and at least one $\had$. Since the fake rate of $\had$ candidate is much larger than for electron or muon, in the majority of the fake lepton events, the $\had$ candidate is misidentified and the electron or muon is prompt based on MC studies. However the multi-jet background has large event rate and can contribute with both electron or muon and $\had$ faked, especially to $t_l\had$ where the fake-lepton dominates.
%and the jet multiplicity is low.
The contribution from these events is estimated with a data-driven method called ABCD.
The estimate is based on the number of tight and loose leptons that passed and failed the PLIV cut in the low and high $\met$ regions. The number of
fake leptons in the signal region is evaluated by rescaling the number of loose leptons in the high $\met$ region with the ratio of tight and loose leptons in the
low $\met$ region. The contribution of prompt leptons in the number of loose leptons is subtracted using MC simulation.     

%This kind of event is modelled by data-driven ABCD method
%by cutting on $\met$ and the tight lepton isolation using PLIV, which is widely used in ATLAS physics analyses.

%\subsubsection{Fake $\tau$-lepton candidates}
%\label{sec:faketaus}
%The background with one or more fake $\had$ candidates mainly arises from $\ttbar$ or
%multijet production, depending on the search channel. 
%Studies based on the simulation show that, for all the above processes, fake $\had$ candidates primarily result from the 
%misidentification of light-quark jets, with the contribution from $b$-quarks and gluon jets playing a subdominant role.
%It is also found that the fake rate decreases for all jet flavours as the $\had$ candidate $\pt$ increases.

%In the hadronic channels, this background is estimated partially from data by defining control regions (CR) enriched in fake $\had$ candidates via loosened $\had$ requirements with% proper fake factors and partially from monte carlo. These CRs do not overlap with the main search regions (SRs), discussed in Section~\ref{sec:strategy_Htautau}. The CR selection %requirements are analogous to those used to define the different SRs, except that the trailing $\had$ candidate is required to fail the medium $\had$ identification.

%In the leptonic channels, the events with real electron or muon and fake taus are modelled by calibrated monte carlo with scale factors derived from the dedicated $t\bar t$
%control regions ($CR_{tt}$) using the SM $t\bar t$ decay of dilepton events and semileptonically double-btagged lepton-jet events.
%The calibration is done depending on different source of the fake taus and \pt. The calibration factor are derived in the dedicated control regions discussed in Section~\ref{sec:st%rategy_Htautau}.
