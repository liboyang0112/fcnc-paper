%-------------------------------------------------------------------------------
\section{Signal and background modelling}
\label{sec:signal_background_model}
%-------------------------------------------------------------------------------

Signal and most background processes are modelled using Monte Carlo (MC) simulation.
After the event preselection, the main background is $\ttbar$ production, often in association with jets, denoted by $\ttbar$+jets in the following.
Small contributions arise from single-top-quark, $W/Z$+jets, multijet and diboson ($WW,WZ,ZZ$) production, as well as from the associated 
production of a vector boson $V$ ($V=W,Z$) or a Higgs boson and a $\ttbar$ pair ($\ttbar V$ and $\ttbar H$). All backgrounds 
with prompt leptons, i.e.\ those originating from the decay of a $W$ boson, a $Z$ boson, or a $\tau$-lepton,
are estimated using samples of simulated events and initially normalised to their theoretical cross sections.
In the simulation, the top-quark and SM Higgs boson masses are set to $172.5~\gev$ and $125~\gev$, respectively,
and the Higgs boson is allowed to decay into all SM particles with branching ratios calculated using \textsc{Hdecay}~\cite{Djouadi:1997yw}.  
Backgrounds with non-prompt electrons or muons, with photons or jets misidentified as electrons, or with jets misidentified as $\had$ candidates, 
generically referred to as fake leptons, are estimated using data-driven methods. 
The background prediction is further improved during the statistical analysis by performing a likelihood 
fit to data using several signal-depleted analysis regions, as discussed in Sections~\ref{sec:strategy_Htautau}.

%-------------------------------------------------------------------------------
\subsection{Simulated signal and background processes}
\label{sec:simulations}
%-------------------------------------------------------------------------------

Samples of simulated $\ttbar \to WbHq$ events were generated with the next-to-leading-order (NLO) generator\footnote{In the following, 
the order of a generator should be understood as referring to the order in the strong coupling constant at which the matrix-element calculation 
is performed.} {\amcatnlolong}~2.4.3~\cite{Alwall:2014hca}  (referred to in the following as {\amcatnlo}) with the NNPDF3.0 NLO~\cite{Ball:2014uwa} parton distribution function (PDF) set and interfaced to {\pythia} 8.212~\cite{Sjostrand:2007gs} with the NNPDF2.3 LO~\cite{Ball:2012cx} PDF set for the modelling of parton showering, hadronisation, and the underlying event. 
The A14~\cite{ATLASUETune4} set of tuned parameters in {\pythia} controlling the description of multiparton interactions and  
initial- and final-state radiation, referred to as the tune, was used.
The signal sample is normalised to the same total cross section as used for the inclusive $t\bar{t}\to WbWb$ sample (see discussion below) and
assuming an arbitrary branching ratio of $\BR_{\mathrm{ref}}(t\to Hq)=1\%$.
The case of both top quarks decaying into $Hq$ is neglected in the analysis given the existing upper limits on $\BR(t \to Hq)$ (Section~\ref{sec:intro}).

The nominal sample used to model the $\ttbar$ background was generated with the NLO generator {\powheg}~v2 \cite{Frixione:2007nw,Nason:2004rx,Frixione:2007vw,Alioli:2010xd} using the NNPDF3.0 NLO PDF set. The {\powheg} model parameter $h_{\textrm{damp}}$, which controls 
matrix element to parton shower matching and effectively regulates the high-$\pt$ radiation, was set to 1.5 times the top-quark mass. 
The parton showers, hadronisation, and underlying event were modelled by {\pythia}~8.210 with the NNPDF2.3 LO PDF set in combination with the A14 tune.
Alternative $\ttbar$ simulation samples used to derive systematic uncertainties are described in Section~\ref{sec:syst_bkgmodeling}. 
The generated $\ttbar$ samples are normalised to a theoretical cross section of $832^{+46}_{-51}$~pb, 
computed using \textsc{Top++}~v2.0~\cite{Czakon:2011xx} at next-to-next-to-leading order (NNLO), 
including resummation of next-to-next-to-leading logarithmic (NNLL) soft gluon 
terms~\cite{Cacciari:2011hy,Baernreuther:2012ws,Czakon:2012zr,Czakon:2012pz,Czakon:2013goa}.

Samples of single-top-quark events corresponding to the $t$-channel production mechanism were generated with the 
{\powheg}~v1~\cite{Frederix:2012dh} generator, using the 4F scheme  for the NLO matrix-element calculations
and the fixed 4F \textsc{CT10}f\textsc{4}~\cite{Lai:2010vv} PDF set.
Samples corresponding to the $tW$- and $s$-channel production mechanisms were generated 
with {\powheg}~v1 using the CT10 PDF set. Overlaps between the $\ttbar$ and $tW$ final states were avoided by using 
the diagram removal scheme~\cite{Frixione:2005vw}.
The parton showers, hadronisation and the underlying event were modelled using {\pythia}~6.428~\cite{Sjostrand:2006za} 
with the CTEQ6L1~\cite{Pumplin:2002vw,Nadolsky:2008zw} PDF set 
in combination with the Perugia 2012 tune~\cite{Skands:2010ak}.
The single-top-quark samples are normalised to the approximate NNLO theoretical cross 
sections~\cite{Kidonakis:2011wy,Kidonakis:2010ux,Kidonakis:2010tc}. 

Samples of $W/Z$+jets events were generated with the {\sherpa}~2.2.1~\cite{Gleisberg:2008ta} generator. 
The matrix element was calculated for up to two partons at NLO and up to four partons at LO using 
\textsc{Comix}~\cite{Gleisberg:2008fv} and \textsc{OpenLoops}~\cite{Cascioli:2011va}. The matrix-element calculation 
is merged with the {\sherpa} parton shower~\cite{Schumann:2007mg} using the ME+PS@NLO prescription~\cite{Hoeche:2012yf}. 
The PDF set used for the matrix-element calculation is NNPDF3.0 NNLO~\cite{Ball:2014uwa} with a dedicated parton shower tuning developed for {\sherpa}. 
Separate samples were generated for different $W/Z$+jets categories using filters for a $b$-jet 
($W/Z$+$\geq$1$b$+jets), a $c$-jet and no $b$-jet ($W/Z$+$\geq$1$c$+jets), and with a veto on $b$- and $c$-jets 
($W/Z$+light-jets), which are combined into the inclusive $W/Z$+jets samples.
Both the $W$+jets and $Z$+jets samples are normalised to their respective inclusive NNLO theoretical 
cross sections calculated with \textsc{FEWZ}~\cite{Anastasiou:2003ds}.

Samples of $WW/WZ/ZZ$+jets events were generated with {\sherpa}~2.2.1 using the CT10 PDF set
and include processes containing up to four electroweak vertices. 
In the case of $WW/WZ$+jets ($ZZ$+jets) the matrix element was calculated for zero (up to one) additional partons 
at NLO and up to three partons at LO using the same procedure as for the $W/Z$+jets samples. 
The final states simulated require one of the bosons to decay leptonically and the other hadronically.
All diboson samples are normalised to their NLO theoretical cross sections provided by {\sherpa}. 

Samples of $\ttbar V$ and $\ttbar H$ events were generated with {\amcatnlo}~2.2.1, using NLO matrix elements and the NNPDF3.0 NLO PDF set,
and interfaced to {\pythia}~8.210 with the NNPDF2.3 LO PDF set and the A14 tune. 
Instead, the $\ttbar V$ samples used in the $\Hbb$ search are based on LO matrix elements computed for up to two additional partons 
using the NNPDF3.0 NLO PDF set, and merged using the CKKW-L approach~\cite{Lonnblad:2001iq}.
The $\ttbar V$ samples are normalised to the NLO cross section computed with {\amcatnlo}, while the $\ttbar H$ sample is normalised using 
the NLO cross section recommended in Ref.~\cite{deFlorian:2016spz}.

All generated samples, except those produced with the {\sherpa}~\cite{Gleisberg:2008ta} event generator, 
utilise \textsc{EvtGen}~1.2.0~\cite{Lange:2001uf} to model the decays of heavy-flavour hadrons. 
To model the effects of pile-up, events from minimum-bias interactions were generated using {\pythia}~8.186~\cite{Sjostrand:2007gs}  
in combination with the A2 tune~\cite{ATL-PHYS-PUB-2011-014}, 
and overlaid onto the simulated hard-scatter events according to the luminosity profile of the recorded data. 
The generated events were processed through a simulation~\cite{Aad:2010ah} of the ATLAS detector geometry and response 
using \textsc{Geant4}~\cite{Agostinelli:2002hh}. A faster simulation, where the full \textsc{Geant4} simulation of
the calorimeter response is replaced by a detailed parameterisation of the shower shapes~\cite{FastCaloSim},
was adopted for some of the samples used to estimate systematic uncertainties in background modelling.
Simulated events were processed through the same reconstruction software as the data, and corrections were applied so that the object identification 
efficiencies, energy scales and energy resolutions match those determined from data control samples.

%-------------------------------------------------------------------------------
\subsection{Backgrounds with fake leptons}
\label{sec:fakeleptons}
%-------------------------------------------------------------------------------

\subsubsection{Fake electrons and muons}
Electrons and muons only appear in the leptonic channels where there is exactly one electron or muon and at least one \had. Since the fake rate of \had candidate is much larger than electron or muon. So in the majority of the fake lepton events, the \had candidate is misidentified and the electron or muon is real, which is also proved by monte carlo studies. However the multi-jet background has large event rate and can contribute with both electron or muon and \had faked to $t_l\had$ where the fake-lepton dominates and the jet multiplicity is low.  This kind of event is modelled by ABCD method widely used in ATLAS physics analyses.

\subsubsection{Fake $\tau$-lepton candidates}
\label{sec:faketaus}
The background with one or more fake $\had$ candidates mainly arises from $\ttbar$ or
multijet production, depending on the search channel. 
Studies based on the simulation show that, for all the above processes, fake $\had$ candidates primarily result from the 
misidentification of light-quark jets, with the contribution from $b$-quarks and gluon jets playing a subdominant role.
It is also found that the fake rate decreases for all jet flavours as the $\had$ candidate $\pt$ increases.

In the hadronic channels, this background is estimated partially from data by defining control regions (CR) enriched in fake $\had$ candidates via loosened $\had$ requirements and partially from monte carlo. These CRs do not overlap with the main search regions (SRs), discussed in Section~\ref{sec:strategy_Htautau}. The CR selection requirements are analogous to those used to define the different SRs, except that the trailing $\had$ candidate is required to fail the medium $\had$ identification.

The fake $\had$ background prediction in a given SR is modelled by the distribution (referred to as the fake $\had$ template) derived from data in the corresponding CR. The fake $\had$ template is defined as the data distribution from which the contributions from the simulated backgrounds with real $\had$ candidates, originating primarily from 
$W(\to \tau\nu)$+jets and $Z(\to \tau\tau)$+jets, are subtracted. In the $\lephad$ channel, simulation studies indicate that the fake $\had$ background composition is consistent between the SR and the CR, and dominated by $\ttbar$ production. In the $\hadhad$ channel, the fake $\had$ background is expected to be dominated by multijet production. However, simulation studies indicate that the contribution of $\ttbar$ events to the fake $\had$ background is higher in the SR than in the CR. Therefore, an appropriate number of simulated $\ttbar$ events with fake $\had$ candidates in the CR is added to the fake $\had$ template to match the fake $\had$ background composition in the SR. 
In both the $\lephad$ and $\hadhad$ channels, the fake $\had$ template in each SR is initially normalised to the estimated fake $\had$ background yield, 
defined as the data yield minus the contributions from the simulated backgrounds with real $\had$ candidates (assuming no signal contribution).
During the statistical analysis, the normalisation of the fake $\had$ background in each SR is allowed to vary freely in the fit to data, as discussed in Section~\ref{sec:results_Htautau}.